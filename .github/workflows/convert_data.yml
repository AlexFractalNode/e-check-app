name: Convert Database for App

on:
  push:
    paths:
      - 'generated_additives.json'  # Nur starten, wenn sich die Daten Ã¤ndern
      - 'convert_db.py'             # Oder das Skript selbst
  workflow_dispatch:                # Manueller Start-Knopf

permissions:
  contents: write

jobs:
  convert-and-commit:
    runs-on: ubuntu-latest

    steps:
      - name: Code auschecken
        uses: actions/checkout@v3

      - name: Python einrichten
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: Konverter ausfÃ¼hren ğŸ
        run: python convert_db.py

      - name: Neue Datenbank speichern (Commit) ğŸ’¾
        run: |
          git config --global user.name "App-Bot ğŸ¤–"
          git config --global user.email "bot@example.com"
          git add app_database.json
          # Nur committen, wenn sich wirklich was geÃ¤ndert hat
          git diff-index --quiet HEAD || (git commit -m "ğŸ“± App-Datenbank aktualisiert" && git push)
